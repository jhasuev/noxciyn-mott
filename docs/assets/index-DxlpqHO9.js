import{P as L}from"./ui-CMHPmd0S.js";import{d as g,c as v,i as r,o as c,g as l,t as h,_ as k,u as x,a as $,b as I,U as P,a6 as b,a2 as _,e as w,w as C,r as S,p as B,h as n,m as M,k as V,F as N,f as T,V as q}from"./index-BH9MdJl8.js";import{s as f}from"./scrollToElement-DnUATCEo.js";const A={class:"progress-circle"},D={viewBox:"0 0 100 100",class:"circle"},E=["stroke-dashoffset"],F={class:"circle-label"},R=45,U=g({__name:"ui",props:{value:{}},setup(m){const o=m,i=2*Math.PI*R,d=v(()=>{const p=Math.min(100,Math.max(0,o.value));return i*(1-p/100)}),u=v(()=>Math.round(o.value));return(p,s)=>(c(),r("div",A,[(c(),r("svg",D,[s[0]||(s[0]=l("circle",{class:"circle-bg",cx:"50",cy:"50",r:"45",fill:"none","stroke-width":"5"},null,-1)),l("circle",{class:"circle-progress","stroke-dasharray":i,"stroke-dashoffset":d.value,cx:"50",cy:"50",r:"45",fill:"none","stroke-width":"5"},null,8,E)])),l("div",F,h(u.value)+"% ",1)]))}}),z=k(U,[["__scopeId","data-v-f7ea2c6b"]]),G={class:"levels-grid"},O=["id","onClick"],W=["src"],j={class:"level-image-wrapper"},H=["src"],J={class:"level-info"},K={class:"level-description"},Q=g({__name:"ui",setup(m){const{locale:o,t:i}=x(),d=$(),u=T(),p=b(),s=I(),y=async e=>{s.canPlayLevel(e.id)&&(await d.play("click"),_({title:e.description[o.value],content:e.startInfo[o.value],image:e.image,props:{},listeners:{},onclosed:()=>{setTimeout(()=>{u.push({name:"Game",query:{id:e.id}})},200)},actions:[{text:i("common.ok"),primary:!0}]}))};return P(()=>{const e=String(p.query.finishedLevelId??"");if(console.log(e),e){if(console.log("finishedLevelId",e),s.getLevelPercent(e)>=100){d.play("levelUp");const a=s.levels.find(t=>t.id==e);_({title:a.description[o.value],content:a.finishedInfo[o.value],image:a.image,isPassed:!0,props:{},listeners:{},onclosed:()=>{q(()=>{f(`#level-${s.getNextLevel(e)}`),setTimeout(()=>{u.push({name:"Levels",query:{}})},300)})},actions:[{text:i("common.ok"),primary:!0}]})}}else{const a=s.passedLevels[s.passedLevels.length-1];console.log("currentLevel",a),a&&f(`#level-${a}`)}}),(e,a)=>(c(),w(L,{title:e.$t("pages.levels.title")},{default:C(()=>[l("div",G,[(c(!0),r(N,null,S(n(s).levels,t=>(c(),r("div",{key:t.id,class:B(["level-tile",{locked:!n(s).canPlayLevel(t.id)}]),id:`level-${t.id}`,onClick:X=>y(t)},[t.image?(c(),r("img",{key:0,class:"level-bg",src:t.image,alt:"Фон уровня"},null,8,W)):M("",!0),l("div",j,[l("img",{class:"level-image",src:t.image||"https://placehold.co/600x400",alt:"Уровень"},null,8,H),V(n(z),{class:"level-image-progress",value:n(s).getLevelPercent(t.id)},null,8,["value"])]),l("div",J,[l("p",K,h(t.description[n(o)]||"..."),1)])],10,O))),128))])]),_:1},8,["title"]))}}),se=k(Q,[["__scopeId","data-v-e2a9b7ba"]]);export{se as default};
